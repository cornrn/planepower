#!/bin/bash
# This script takes every *.c file in the curernt directory,
# strips out the "evaluate" function (which must be the last thing
# in the file), clobbers "const" specifiers, renames the function
# after the file, and consolidates it into a single .cpp file.

outfile=casadi_functions.cpp

echo "//Warning!!! This file was auto-generated by the rename_casadi_functions script!" > $outfile
echo "#include <math.h>" >> $outfile
for x in `ls *.c`
do
	y=`basename $x .c`
	sed -e "s/evaluate/${y}/" -ne "/${y}/,$ p" < $x >> $outfile
done
sed -i -e 's/const//' $outfile
sed -i -e 's/\<d\>/double/' $outfile
