#!/usr/bin/env deployer

#Import libraries
import("cameraTrigger")
import("soem_master")
import("soem_ebox")
import("LEDTracker")
 
#Create components
loadComponent("soemMaster","soem_master::SoemMasterComponent")
loadComponent("cameraTrigger","OCL::CameraTrigger")
loadComponent("LEDTracker","OCL::LEDTracker")
LEDTracker.useExternalTrigger = true

#Load properties
#loadService("LEDTracker","marshalling")
#LEDTracker.marshalling.loadProperties("../../../properties/LEDTracker/LEDTracker.cpf")

#Set activities
setActivity("LEDTracker",0.00,HighestPriority,ORO_SCHED_RT)
#setActivity("LEDTracker",0.05,HighestPriority,ORO_SCHED_RT)
#setActivity("LEDTracker",0.1,HighestPriority,ORO_SCHED_RT) 

var double base_hz = 5;
setActivity("cameraTrigger",1.0/base_hz,HighestPriority,ORO_SCHED_RT)
setActivity("soemMaster",.005,HighestPriority,ORO_SCHED_RT)
soemMaster.ifname = "eth1"

connectPeers("cameraTrigger","soemMaster")

soemMaster.configure()
soemMaster.start()

cameraTrigger.configure()
cameraTrigger.start()

LEDTracker.configure()
LEDTracker.start()
